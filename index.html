<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<title>Bot Factory Simulator 3D</title>
<style>
/* --- GENERAL --- */
body, html {
  margin:0; padding:0;
  width:100%; height:100%;
  font-family: 'Arial', sans-serif;
  background:#1b1b2f;
  overflow-x:hidden;
  touch-action: manipulation;
  user-select:none;
}

/* --- BACKGROUND --- */
#background {
  position:fixed; top:0; left:0;
  width:100%; height:100%;
  background: linear-gradient(90deg,#1b1b2f,#2b2b3f);
  overflow:hidden;
  z-index:-1;
}

/* Floating gears/particles */
.gear {
  position:absolute;
  border-radius:50%;
  background:#33f;
  opacity:0.3;
  animation: float 5s linear infinite;
}
@keyframes float { 0%{transform:translateY(110%);} 100%{transform:translateY(-10%);} }

/* --- STATS PANEL --- */
#stats {
  display:flex; justify-content:space-around; margin:10px auto;
  width:90%;
}
.stat-box {
  flex:1;
  margin:0 5px;
  padding:15px;
  background: linear-gradient(145deg,#0f0f2f,#333366);
  border-radius:15px;
  color:#0ff;
  font-weight:bold;
  text-shadow: 2px 2px 0 #000;
  box-shadow: 0 0 15px #33f;
  min-width:90px;
  text-align:center;
  font-size:16px;
  transition:0.2s;
}

/* --- MACHINE CONTROLLER BUTTON --- */
#clickBot {
  display:block;
  margin:20px auto;
  width:160px; height:160px;
  border:none;
  border-radius:20px;
  background: linear-gradient(145deg,#0ff,#33f);
  box-shadow:0 0 35px #0ff, inset 0 0 15px #00f;
  font-size:22px; color:#fff;
  font-weight:bold;
  text-shadow:2px 2px 0 #000;
  transition:0.1s;
}
#clickBot:active {
  transform:scale(0.95);
  box-shadow:0 0 50px #0ff, inset 0 0 25px #00f;
}

/* --- CONVEYOR BELT --- */
.conveyor {
  position:relative;
  margin:20px auto;
  width:90%;
  height:100px;
  background: repeating-linear-gradient(90deg,#222244 0 40px,#333366 40px 80px);
  border-radius:15px;
  overflow:hidden;
  box-shadow: 0 0 20px #33f;
}

/* --- BOT SPRITES --- */
.botSprite {
  position:absolute;
  width:28px; height:28px;
  background: linear-gradient(145deg,#0ff,#00f);
  border-radius:50%;
  box-shadow: 2px 2px 0 #000, 0 0 10px #0ff;
  top:36px;
}

/* --- UPGRADE CARDS --- */
#upgrades {
  display:flex; flex-direction:column; gap:10px;
  width:90%; margin:20px auto;
}
.upgrade {
  padding:12px;
  background: linear-gradient(145deg,#0f0f2f,#222244);
  border:2px solid #33f;
  border-radius:15px;
  color:#0ff;
  text-align:center;
  font-weight:bold;
  font-size:16px;
  text-shadow:2px 2px 0 #000;
  box-shadow:0 0 20px #33f;
  cursor:pointer;
  transition:0.2s;
}
.upgrade:hover {
  transform:scale(1.05);
  box-shadow:0 0 35px #0ff;
}

/* --- PRESTIGE BUTTON --- */
#prestige {
  width:90%; margin:20px auto; padding:15px;
  background: linear-gradient(145deg,#0ff,#33f);
  border:none;
  border-radius:20px;
  color:#111;
  font-weight:bold;
  font-size:18px;
  text-shadow:2px 2px 0 #000;
  box-shadow:0 0 30px #0ff;
}

/* --- FLOATING TEXT --- */
.float-text {
  position:absolute;
  font-weight:bold;
  color:#0ff;
  pointer-events:none;
  user-select:none;
  text-shadow:2px 2px 0 #000;
  animation: floatUp 1s forwards;
}
@keyframes floatUp { 0%{opacity:1; transform:translateY(0) scale(1);} 100%{opacity:0; transform:translateY(-80px) scale(1.5);} }

/* --- FLYING COINS --- */
.coin {
  position:absolute;
  width:18px; height:18px;
  background: radial-gradient(circle,#ff0,#cc0);
  border-radius:50%;
  pointer-events:none;
  box-shadow:2px 2px 0 #000,0 0 10px #ff0;
}
</style>
</head>
<body>
<div id="background"></div>

<div id="game-container">
  <h1 style="text-align:center; color:#0ff; text-shadow:3px 3px 0 #000;">Bot Factory Simulator 3D</h1>

  <div id="stats">
    <div class="stat-box">Bots: <span id="botCount">0</span></div>
    <div class="stat-box">Coins: <span id="coinCount">0</span></div>
  </div>

  <button id="clickBot">Activate Machine</button>

  <div class="conveyor" id="conveyor"></div>

  <div id="upgrades">
    <div class="upgrade" id="upgradeClick">Increase Click (+1) - Cost: <span id="upgradeClickCost">10</span> coins</div>
    <div class="upgrade" id="upgradeIdle">Increase Idle (+1/sec) - Cost: <span id="upgradeIdleCost">20</span> coins</div>
    <div class="upgrade" id="prestige">Prestige x2 - Req: <span id="prestigeReq">50 bots</span></div>
  </div>
</div>

<script>
// --- GAME STATE ---
let game = {
  bots:0,
  coins:0,
  clickPower:1,
  idlePower:0,
  prestigeMultiplier:1,
  upgradeClickCost:10,
  upgradeIdleCost:20,
  prestigeReq:50
};

// DOM Elements
const botCountEl = document.getElementById("botCount");
const coinCountEl = document.getElementById("coinCount");
const clickBtn = document.getElementById("clickBot");
const upgradeClickBtn = document.getElementById("upgradeClick");
const upgradeIdleBtn = document.getElementById("upgradeIdle");
const prestigeBtn = document.getElementById("prestige");
const upgradeClickCostEl = document.getElementById("upgradeClickCost");
const upgradeIdleCostEl = document.getElementById("upgradeIdleCost");
const prestigeReqEl = document.getElementById("prestigeReq");
const conveyor = document.getElementById("conveyor");

// --- LOAD GAME ---
if(localStorage.getItem("botFactoryGame")){
  game = JSON.parse(localStorage.getItem("botFactoryGame"));
  updateDisplay();
}

// --- CLICK MACHINE ---
clickBtn.addEventListener("click", ()=>{
  addBots(game.clickPower*game.prestigeMultiplier);
  spawnBot();
});

// --- ADD BOTS ---
function addBots(amount){
  game.bots += amount;
  game.coins += amount;
  createFloatingText(`+${amount}`, clickBtn);
  flyCoins(amount);
  updateDisplay();
}

// --- FLOATING TEXT ---
function createFloatingText(text,target){
  const el = document.createElement("div");
  el.className="float-text";
  el.textContent=text;
  const rect = target.getBoundingClientRect();
  el.style.left=(rect.left+rect.width/2-20)+"px";
  el.style.top=(rect.top-30)+"px";
  document.body.appendChild(el);
  setTimeout(()=>el.remove(),1000);
}

// --- FLYING COINS ---
function flyCoins(amount){
  const rect = clickBtn.getBoundingClientRect();
  for(let i=0;i<Math.min(amount,10);i++){
    const coin = document.createElement("div");
    coin.className="coin";
    coin.style.left=(rect.left+rect.width/2)+"px";
    coin.style.top=(rect.top+rect.height/2)+"px";
    document.body.appendChild(coin);
    animateCoin(coin);
  }
}
function animateCoin(coin){
  const targetRect = coinCountEl.getBoundingClientRect();
  const dx = targetRect.left - parseFloat(coin.style.left);
  const dy = targetRect.top - parseFloat(coin.style.top);
  let posX=parseFloat(coin.style.left), posY=parseFloat(coin.style.top);
  let step =0;
  function move(){
    posX+=dx*0.05; posY+=dy*0.05; step+=0.05;
    coin.style.left=posX+"px";
    coin.style.top=posY+"px";
    if(step<1) requestAnimationFrame(move); else coin.remove();
  }
  move();
}

// --- SPAWN BOT ON CONVEYOR ---
function spawnBot(){
  const bot = document.createElement("div");
  bot.className="botSprite";
  bot.style.left="0px";
  bot.style.top=(Math.random()*50+25)+"px";
  conveyor.appendChild(bot);
  let pos=0;
  const speed=2+Math.random()*2;
  function move(){
    pos+=speed;
    bot.style.left=pos+"px";
    if(pos>conveyor.offsetWidth){
      bot.remove();
      flyCoins(1);
      return;
    }
    requestAnimationFrame(move);
  }
  move();
}

// --- UPGRADES ---
upgradeClickBtn.addEventListener("click",()=>{
  if(game.coins>=game.upgradeClickCost){
    game.coins-=game.upgradeClickCost;
    game.clickPower+=1;
    game.upgradeClickCost=Math.floor(game.upgradeClickCost*1.5);
    updateDisplay();
  }
});
upgradeIdleBtn.addEventListener("click",()=>{
  if(game.coins>=game.upgradeIdleCost){
    game.coins-=game.upgradeIdleCost;
    game.idlePower+=1;
    game.upgradeIdleCost=Math.floor(game.upgradeIdleCost*1.5);
    updateDisplay();
  }
});
prestigeBtn.addEventListener("click",()=>{
  if(game.bots>=game.prestigeReq){
    game.bots=0; game.coins=0;
    game.clickPower=1; game.idlePower=0;
    game.prestigeMultiplier*=2;
    game.upgradeClickCost=10;
    game.upgradeIdleCost=20;
    updateDisplay();
    alert(`Prestige activated! Multiplier is now x${game.prestigeMultiplier}`);
  }
});

// --- IDLE PRODUCTION ---
setInterval(()=>{
  if(game.idlePower>0){
    addBots(game.idlePower*game.prestigeMultiplier);
    spawnBot();
  }
},1000);

// --- UPDATE DISPLAY ---
function updateDisplay(){
  botCountEl.textContent=game.bots;
  coinCountEl.textContent=game.coins;
  upgradeClickCostEl.textContent=game.upgradeClickCost;
  upgradeIdleCostEl.textContent=game.upgradeIdleCost;
  prestigeReqEl.textContent=game.prestigeReq;
  saveGame();
}

// --- SAVE GAME ---
function saveGame(){
  localStorage.setItem("botFactoryGame",JSON.stringify(game));
}

// --- BACKGROUND GEARS ---
for(let i=0;i<20;i++){
  const g = document.createElement("div");
  g.className="gear";
  g.style.left=Math.random()*100+"%";
  g.style.width=(10+Math.random()*20)+"px";
  g.style.height=g.style.width;
  g.style.animationDuration=(5+Math.random()*10)+"s";
  document.body.appendChild(g);
}
</script>
</body>
</html>
